var util = require('util'),
    _ = require('underscore'),
    ResourceBag = require('logic/Resources/ResourceBag/ResourceBag'),
    logger = require('service/Logger/logger'),
    defaults = {
        sand: 20,
        wood: 18,
        brick: 15,
        stone: 15,
        silver: 15,
        money: 105
    };

var Treasury = function(config) {
    logger.trace('Treasury create', config);
    ResourceBag.call(this, config || defaults );
};

util.inherits(Treasury, ResourceBag);

_(Treasury.prototype).extend({
    _enough: function() {
        return true;
    },

    _get: function(schema) {
        var pairs = _(schema).pairs();
        return _(pairs).reduce(function(acc, pair) {
            var key = pair[0],
                value = pair[1],
                amount = Math.min(this[key], value);

            acc[key] = amount;
            this[key] -= amount;

            return acc;
        }, {}, this);
    }

});

module.exports = Treasury;
