var vows = require('vows'),
    sinon = require('sinon'),
    assert = require('assert'),
    _ = require('underscore'),
    Game = require('./Game'),
    Player = require('logic/player/Player');

vows.describe('Game').addBatch({
    'players gathering phase': {
        'should not allow players to join if game has already started': function() {
            var game = new Game({
                maxPlayers: 2
            });

            game.join(new Player());
            game.join(new Player());
            game.start();

            sinon.spy(game, 'emit');

            game.join(new Player());
            assert.equal(game.emit.getCall(0).args[0], 'game.error');
        }
    }
}).export(module);
